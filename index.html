<!DOCTYPE html>
<html>
  <head>
    <title>Feature Toggles: en enkel teknikk for å levere funksjonalitet enda raskere</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" type="text/css" href="styles/styles.css">
  </head>
  <body>
    <textarea id="source">

class: center, middle, inverse

# Feature Toggles
#### en enkel teknikk for å levere funksjonalitet enda raskere

### Ivar Conradi Østhus 

<table class="bottom">
  <tr>
    <td class="rightify"><img src="images/twitter.png" height="20" /></td>
    <td class="leftify strong">@ivarconr</td>
  </tr>
  <tr> 
    <td class="rightify"><img src="images/finn.png" height="20" /></td>
    <td class="leftify strong">ico@finn.no</td>
  </tr>
</table>

???
- Ivar Østhus
- 29år 
- jobber som utvikler i FINN
- feature toggles

---
class: background-img

# master == motorvei til produksjon
<img src="images/highway.jpg">

???
- I FINN bruker vi master branchen som motorvei til prduksjon
 - Ruller ut artifakter flere ganger daglig
- Kode som sjekkes inn på master:
 - bli bygget og enhets-tester kjøres
 - automatisk bli deployet til testmiljøer
 - integrasjonstester blir trigget
 - ny kode kan så deployes til produksjon
- Alt som sjekkes inn på master: 
  - _skal potensielt kunne havne i produksjon_


---
# Utfordinger
- Optimalisert for å få ut små endringer / bugfixes
- Det tar tid å utvikle nye funksjoner (1-3 uker)
 - flere personer og team
 - flere moduler/applikasjoner 
- Testmiljøer != produksjon

---
# Feature Branches

<img class="fullwitdh border" src="images/feature_branch_simple.jpg" />

???
- Enkel teknikk 
- separate "feature branches" for å utvikle ny funksjonalitet
- disse merges inn når funksjonen er klar

---
class: center, middle
<img  src="images/pull_request.png" />

---
# Feature Branches: parallel features

<img class="fullwitdh border" src="images/feature_branch_double.jpg" />

---
class: background-img
<img  src="images/keep-refactoring-and-carry-on.png" />

???
Ekstra vanskelig å refaktorere med feature branches.
- rammeverk
- bibliotekter
- refaktoreringer

---
# Feature Branches

**Fordeler:**
- Trygt å sjekke inn kode i egen branch
- Ingen kode havner i produksjon før vi er klar
- Teste nye ting uten at det berører andre
- Code review med _pull-requests_

**Ulemper:**
- Kan fort bli veldig dyrt/komplisert å merge
- Vanskelig å dele __ny kode__ på tvers av brancher
- Frykt for å refaktorere felleskode (rammeverk / bibliotek)
- Vanskelig(ere) å vise frem ny kode før den er merget
- Egne test-miljøer per branch?

---
class: background-img
# Feature Toggles
<img src="images/Merrydown_Cider Factory.jpg">

???
Feature Toggles er en enkel teknikk
- lar oss jobbe på master-bransjen
- gjør det mulig å release uferdig kode til produksjon
- skjuler uferdig funksjonalitet fra brukeren
- gjør oss i stand til å teste nye funksjoner i produksjon (uten at brukerene eksponeres)
- gir oss kontroll på når og hvordan vi ruller ut en ny funksjon til brukerne

---
# Feature Toggles: Enkle if-tester

```java
if(unleash.isEnabled("AwesomeFeature")) {
  //do some magic
} else {
  //do old boring stuff
}
```

---
# Minimal impact!
- Bruk så få _if_-sjekker som mulig
- Beskytt ingangang (lenke) til nye UI-komponenter
- Nye APIer trenger ikke beskyttelse
 - eksisterende klienter kjenner ikke til muligheten

---
class: background-img
# Rydd etter deg!
<img src="images/pollution.jpg">

???
- Når du ikke trenger en feature toggles lenger skal denne slettes
- Kostbart å vedlikeholde over tid
- Så få permanente feature toggles som mulig

---
# Aktiveringsstrategier
- #### For alle
- #### For spesifikke brukere
- #### På angitt server node
- #### Basert på dato
- #### Gradivs utrulling

---
# Økt kontroll
- hvem får tilgang til en ny funksjon og når
- gradivs utrulling
- lynrask og enkel _tilbakerulling_

???
tilbakerulling: feil eller negativ KPI


---
# Anbefalt arbeidsflyt
1. Bruk kortvarige arbeids-brancher _per del_ for ny funksjon
 - lever maks et par dager
2. Lag pull-request
 - merge til master når teamet godkjenner endring
 - rull ut til produksjon
3. Aktiver funksjon for teamet i **produksjon**
4. Test funksjonen
5. (fiks eventuelle feil / forbedringer)
6. Aktiver funksjonen gradvis for alle brukere
7. Følg med på logger, bugs, KPI, osv.
8. Fjern 'Feature Toggle' fra koden


???
Jeg har brukt feature toggles en stund

Abridsbrancher for bruke pull requests!
- Små pullrequester => enklere å forstå / gi tilbakemleding

---
# Feature toggles
- #### Unngår tidkrevende "big bang merges"
- #### Inkrementell utvikling av funksjoner
- #### Rulle ut uferdig kode til produksjon
- #### Teste ny (uferdig) funksjonalitet tidlig i produksjon
- #### Kontroll med når nye funksjoner aktiveres
- #### Gradvis utrulling til brukere
- #### Lynrask tilbakerulling



---
class: inverse
# Takk for meg!

** Unleash** - open source rammeverk for feature toggles. <br />
[https://github.com/finn-no/unleash](https://github.com/finn-no/unleash)

<br />
<table class="bottom">
  <tr>
    <td class="rightify"><img src="images/twitter.png" height="20" /></td>
    <td class="leftify strong">@ivarconr</td>
  </tr>
  <tr> 
    <td class="rightify"><img src="images/finn.png" height="20" /></td>
    <td class="leftify strong">ico@finn.no</td>
  </tr>
</table>

.gray[
**Kilder**
- http://martinfowler.com/bliki/FeatureToggle.html
- http://en.wikipedia.org/wiki/Feature_toggle
- http://blog.pluralsight.com/favor-feature-toggles-over-feature-branches
- http://www.slideshare.net/anandagrawal84/feature-toggles
- http://www.infoq.com/presentations/Feature-Bits
- http://codeascraft.com/2011/02/04/how-does-etsy-manage-development-and-operations/
- http://blog.disqus.com/post/789540337/partial-deployment-with-feature-switches
]

    </textarea>
    <script src="scripts/remark-latest.min.js" type="text/javascript">
    </script>
    <script type="text/javascript">
      var slideshow = remark.create();
    </script>
  </body>
</html>